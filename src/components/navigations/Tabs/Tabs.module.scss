/* Copyright (c) Fortanix, Inc.
|* This Source Code Form is subject to the terms of the Mozilla Public License, v. 2.0. If a copy of
|* the MPL was not distributed with this file, You can obtain one at http://mozilla.org/MPL/2.0/. */

@use '../../../styling/defs.scss' as bk;

@layer baklava.components {
  .bk-tabs {
    @include bk.component-base(bk-tabs);
    
    .bk-tabs__switcher {
      display: flex;
      list-style: none;
      border-block-end: 1px solid #{bk.$theme-tab-rule-default};
      --active-tab-indicator-size: calc(5 * #{bk.$size-hairline});
      
      .bk-tabs__switcher__tab {
        cursor: pointer;
        position: relative;
        user-select: none;
        
        padding: bk.$spacing-3 bk.$spacing-8;
        
        display: grid;
        grid-template-areas: "stack";
        
        > * {
          grid-area: stack;
          text-align: center;
        }
        
        color: #{bk.$theme-tab-text-default};
        @include bk.font(bk.$font-family-body, bk.$font-weight-semibold, bk.$font-size-m);
        text-transform: uppercase;
        white-space: nowrap;
        
        // The active tab underline (zero height by default)
        &::after {
          content: "";
          position: absolute;
          inline-size: 100%;
          inset-inline-start: 0;
          inset-block-end: 0;
          block-size: 0;
          transition: .3s;
        }
        
        > .bk-tabs__switcher__tab__hover-placeholder {
          visibility: hidden;
          font-weight: bk.$font-weight-bold;
        }
        
        &:is(:hover, :global(.pseudo-hover)) {
          font-weight: bk.$font-weight-bold;
          
          &::after {
            background-color: #{bk.$theme-tab-tabs-hover};
            block-size: var(--active-tab-indicator-size);
          }
        }
        
        &:is(:focus-visible, :global(.pseudo-focus-visible)) {
          font-weight: bk.$font-weight-bold;
          
          &::after {
            background-color: #{bk.$theme-tab-tabs-selected};
            block-size: var(--active-tab-indicator-size);
          }
        }
        
        &[aria-selected="true"] {
          font-weight: bk.$font-weight-bold;
          
          &::after {
            cursor: default;
            background-color: #{bk.$theme-tab-tabs-selected};
            block-size: var(--active-tab-indicator-size);
          }
        }
      }
    }
    
    .bk-tabs__tab-content {
      padding-block-start: bk.$spacing-7;
    }

    &.bk-tabs--secondary:not(.bk-tabs-vertical) {
      margin-inline: calc(-1 * var(--bk-panel-inset-compensation));
      
      .bk-tabs__switcher {
        --active-tab-indicator-size: calc(2 * #{bk.$size-hairline});

        .bk-tabs__switcher__tab {
          @include bk.font(bk.$font-family-body, bk.$font-weight-regular, bk.$font-size-m);
          text-transform: capitalize;

          >.bk-tabs__switcher__tab__hover-placeholder {
            font-weight: bk.$font-weight-regular;
          }

          &:is(:hover, :global(.pseudo-hover)) {
            font-weight: bk.$font-weight-regular;
          }

          &:is(:focus-visible, :global(.pseudo-focus-visible)) {
            font-weight: bk.$font-weight-regular;
          }

          &[aria-selected="true"] {
            font-weight: bk.$font-weight-regular;
          }
        }
      }
      
      .bk-tabs__tab-content {
        padding-inline: var(--bk-panel-inset-compensation);
      }
    }

    &.bk-tabs--vertical {
      display: flex;
      // If we are inside of an edgeless panel, stretch tabs to the edges
      --negative-margin: calc(-1 * var(--bk-panel-inset-compensation));
      margin: var(--negative-margin) var(--negative-margin) 0 var(--negative-margin);
      
      .bk-tabs__switcher {
        flex-direction: column;
        inline-size: bk.rem-from-px(216);
        gap: bk.$spacing-3;
        padding: bk.$spacing-6 0;
        border-block-end: 0;
        border-inline-end: 1px solid bk.$theme-side-nav-menu-background-hover;

        .bk-tabs__switcher__tab {
          font-weight: bk.$font-weight-regular;
          text-transform: capitalize;

          >.bk-tabs__switcher__tab__hover-placeholder {
            font-weight: bk.$font-weight-regular;
          }

          &:is(:hover, :global(.pseudo-hover)) {
            background: bk.$theme-side-nav-menu-background-hover;
            font-weight: bk.$font-weight-semibold;
          }

          &:is(:focus-visible, :global(.pseudo-focus-visible)) {
            background: bk.$theme-side-nav-menu-background-focused;
            font-weight: bk.$font-weight-semibold;
          }

          &::after {
            display: none;
          }

          >* {
            text-align: start;
          }

          &[aria-selected="true"] {
            background: bk.$theme-side-nav-menu-background-focused;
            font-weight: bk.$font-weight-semibold;
          }
        }
      }

      .bk-tabs__tab-content {
        flex: 1;
        padding: bk.$spacing-7;
        margin-block-end: var(--negative-margin);
        --bk-panel-inset-compensation: #{bk.$spacing-7};
      }
    }
  }
}
